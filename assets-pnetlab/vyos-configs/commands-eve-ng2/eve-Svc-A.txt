
set interfaces ethernet eth0 mtu '8896'
set interfaces ethernet eth0 address '10.10.15.104/24'
set interfaces ethernet eth0 vrf 'oob'

set interfaces ethernet eth1 mtu '8896'

set interfaces ethernet eth2 mtu '8846'
set interfaces ethernet eth2 address '3.0.1.2/30'
set interfaces ethernet eth2 ipv6 address
set interfaces ethernet eth2 address 'fd:0:0:301::2222/64'

set interfaces ethernet eth3 mtu '8846'
set interfaces ethernet eth3 address '4.0.1.2/30'
set interfaces ethernet eth3 ipv6 address
set interfaces ethernet eth3 address 'fd:0:0:401::2222/64'
set interfaces ethernet eth3 disable

set interfaces ethernet eth4 mtu '8846'

set interfaces ethernet eth5 mtu '8846'
set interfaces ethernet eth5 disable

set interfaces loopback lo address '10.0.99.1/32'
set interfaces loopback lo address 'fd:0:0:99::1111/64'

set interfaces bridge br100 mtu '8846'
set interfaces bridge br100 address '10.99.100.2/24'
set interfaces bridge br100 member interface eth1
set interfaces bridge br100 member interface eth4
#set interfaces bridge br100 member interface eth5

set high-availability vrrp group gw-100 address 10.99.100.1/24
set high-availability vrrp group gw-100 advertise-interval '1'
set high-availability vrrp group gw-100 interface 'br100'
set high-availability vrrp group gw-100 no-preempt
set high-availability vrrp group gw-100 priority '100'
set high-availability vrrp group gw-100 vrid '100'

set high-availability vrrp group gw-101 address 10.99.101.1/24
set high-availability vrrp group gw-101 advertise-interval '1'
set high-availability vrrp group gw-101 interface 'br100'
set high-availability vrrp group gw-101 no-preempt
set high-availability vrrp group gw-101 priority '100'
set high-availability vrrp group gw-101 vrid '101'

set high-availability vrrp group gw-102 address 10.99.102.1/24
set high-availability vrrp group gw-102 advertise-interval '1'
set high-availability vrrp group gw-102 interface 'br100'
set high-availability vrrp group gw-102 no-preempt
set high-availability vrrp group gw-102 priority '100'
set high-availability vrrp group gw-102 vrid '102'

set high-availability vrrp group gw-103 address 10.99.103.1/24
set high-availability vrrp group gw-103 advertise-interval '1'
set high-availability vrrp group gw-103 interface 'br100'
set high-availability vrrp group gw-103 no-preempt
set high-availability vrrp group gw-103 priority '100'
set high-availability vrrp group gw-103 vrid '103'

set high-availability vrrp group gw-104 address 10.99.104.1/24
set high-availability vrrp group gw-104 advertise-interval '1'
set high-availability vrrp group gw-104 interface 'br100'
set high-availability vrrp group gw-104 no-preempt
set high-availability vrrp group gw-104 priority '100'
set high-availability vrrp group gw-104 vrid '104'

set high-availability vrrp group gw-105 address 10.99.105.1/24
set high-availability vrrp group gw-105 advertise-interval '1'
set high-availability vrrp group gw-105 interface 'br100'
set high-availability vrrp group gw-105 no-preempt
set high-availability vrrp group gw-105 priority '100'
set high-availability vrrp group gw-105 vrid '105'

set high-availability vrrp group gw-106 address 10.99.106.1/24
set high-availability vrrp group gw-106 advertise-interval '1'
set high-availability vrrp group gw-106 interface 'br100'
set high-availability vrrp group gw-106 no-preempt
set high-availability vrrp group gw-106 priority '100'
set high-availability vrrp group gw-106 vrid '106'

set high-availability vrrp group gw-107 address 10.99.107.1/24
set high-availability vrrp group gw-107 advertise-interval '1'
set high-availability vrrp group gw-107 interface 'br100'
set high-availability vrrp group gw-107 no-preempt
set high-availability vrrp group gw-107 priority '100'
set high-availability vrrp group gw-107 vrid '107'

set high-availability vrrp group gw-105-v6 address fd:0:99:105::1111/64
set high-availability vrrp group gw-105-v6 advertise-interval '1'
set high-availability vrrp group gw-105-v6 interface 'br100'
set high-availability vrrp group gw-105-v6 no-preempt
set high-availability vrrp group gw-105-v6 priority '100'
set high-availability vrrp group gw-105-v6 vrid '056'

set high-availability vrrp group gw-106-v6 address fd:0:99:106::1111/64
set high-availability vrrp group gw-106-v6 advertise-interval '1'
set high-availability vrrp group gw-106-v6 interface 'br100'
set high-availability vrrp group gw-106-v6 no-preempt
set high-availability vrrp group gw-106-v6 priority '100'
set high-availability vrrp group gw-106-v6 vrid '066'


set policy prefix-list route-filter rule 10 action 'deny'
set policy prefix-list route-filter rule 10 prefix '10.15.0.0/16'

set policy prefix-list route-filter rule 11 action 'deny'
set policy prefix-list route-filter rule 11 prefix '1.0.0.0/8'

set policy prefix-list route-filter rule 12 action 'deny'
set policy prefix-list route-filter rule 12 prefix '2.0.0.0/8'

set policy prefix-list route-filter rule 13 action 'deny'
set policy prefix-list route-filter rule 13 prefix '3.0.0.0/8'

set policy prefix-list route-filter rule 14 action 'deny'
set policy prefix-list route-filter rule 14 prefix '4.0.0.0/8'

set policy prefix-list route-filter rule 15 action 'deny'
set policy prefix-list route-filter rule 15 prefix '5.0.0.0/8'

set policy prefix-list route-filter rule 16 action 'deny'
set policy prefix-list route-filter rule 16 prefix '6.0.0.0/8'

set policy prefix-list route-filter rule 98 action 'permit'
set policy prefix-list route-filter rule 98 prefix '192.168.99.0/24'

set policy prefix-list route-filter rule 99 action 'permit'
set policy prefix-list route-filter rule 99 prefix '172.16.0.0/16'

set policy prefix-list route-filter rule 100 action 'permit'
set policy prefix-list route-filter rule 100 prefix '192.168.0.0/16'

set policy prefix-list route-filter rule 101 action 'permit'
set policy prefix-list route-filter rule 101 prefix '0.0.0.0/0'

set policy prefix-list route-redist-filtering description 'Preventdistribution of local point-2-point links and mgmt interface'
set policy prefix-list route-redist-filtering rule 10 action 'deny'
set policy prefix-list route-redist-filtering rule 10 prefix '10.15.0.0/16'

set policy prefix-list route-redist-filtering rule 100 action 'permit'
set policy prefix-list route-redist-filtering rule 100 description 'allow any CIDR of size /29 or less. i.e. block exchange of ptp local links'
set policy prefix-list route-redist-filtering rule 100 le '29'
set policy prefix-list route-redist-filtering rule 100 prefix '0.0.0.0/0'

set policy prefix-list route-redist-filtering2 rule 10 action 'deny'
set policy prefix-list route-redist-filtering2 rule 10 prefix '10.15.0.0/16'

set policy prefix-list route-redist-filtering2 rule 100 action 'permit'
set policy prefix-list route-redist-filtering2 rule 100 ge '16'
set policy prefix-list route-redist-filtering2 rule 100 prefix '192.168.0.0/16'

set policy prefix-list route-redist-filtering2 rule 101 action 'permit'
set policy prefix-list route-redist-filtering2 rule 101 ge '16'
set policy prefix-list route-redist-filtering2 rule 101 prefix '172.16.0.0/16'

set policy prefix-list route-redist-filtering2 rule 110 action 'permit'
set policy prefix-list route-redist-filtering2 rule 110 ge '8'
set policy prefix-list route-redist-filtering2 rule 110 prefix '10.0.0.0/8'

set policy prefix-list route-redist-filtering2 rule 120 action 'permit'
set policy prefix-list route-redist-filtering2 rule 120 ge '16'
set policy prefix-list route-redist-filtering2 rule 120 prefix '1.0.0.0/16'

set policy prefix-list route-redist-filtering2 rule 121 action 'permit'
set policy prefix-list route-redist-filtering2 rule 121 ge '16'
set policy prefix-list route-redist-filtering2 rule 121 prefix '2.0.0.0/16'

set policy prefix-list route-redist-filtering2 rule 122 action 'permit'
set policy prefix-list route-redist-filtering2 rule 122 ge '16'
set policy prefix-list route-redist-filtering2 rule 122 prefix '3.0.0.0/16'

set policy prefix-list route-redist-filtering2 rule 123 action 'permit'
set policy prefix-list route-redist-filtering2 rule 123 ge '16'
set policy prefix-list route-redist-filtering2 rule 123 prefix '4.0.0.0/16'

set policy prefix-list route-redist-filtering2 rule 124 action 'permit'
set policy prefix-list route-redist-filtering2 rule 124 ge '16'
set policy prefix-list route-redist-filtering2 rule 124 prefix '5.0.0.0/16'

set policy prefix-list route-redist-filtering2 rule 125 action 'permit'
set policy prefix-list route-redist-filtering2 rule 125 ge '16'
set policy prefix-list route-redist-filtering2 rule 125 prefix '6.0.0.0/16'

set policy prefix-list route-redist-filtering2 rule 200 action 'permit'
set policy prefix-list route-redist-filtering2 rule 200 prefix '0.0.0.0/0'

set policy prefix-list6 route-redist-filtering6 rule 620 action 'permit'
set policy prefix-list6 route-redist-filtering6 rule 620 ge '48'
set policy prefix-list6 route-redist-filtering6 rule 620 prefix 'fd::/48'

set protocols bfd peer 3.0.1.1
set protocols bfd peer 4.0.1.1

set protocols bgp address-family ipv4-unicast redistribute connected
set protocols bgp address-family ipv4-unicast redistribute static

set protocols bgp address-family ipv6-unicast network fd:0::/32
set protocols bgp address-family ipv6-unicast redistribute connected
set protocols bgp address-family ipv6-unicast redistribute static

set protocols bgp listen range 10.99.105.0/24 peer-group 'dyn-peers-rs-105'

set protocols bgp neighbor 3.0.1.1 address-family ipv4-unicast
set protocols bgp neighbor 3.0.1.1 bfd
set protocols bgp neighbor 3.0.1.1 remote-as '65002'
set protocols bgp neighbor 3.0.1.1 timers holdtime '9'
set protocols bgp neighbor 3.0.1.1 timers keepalive '3'
set protocols bgp neighbor 3.0.1.1 update-source '3.0.1.2'

set protocols bgp neighbor 4.0.1.1 address-family ipv4-unicast
set protocols bgp neighbor 4.0.1.1 bfd
set protocols bgp neighbor 4.0.1.1 remote-as '65002'
set protocols bgp neighbor 4.0.1.1 timers holdtime '9'
set protocols bgp neighbor 4.0.1.1 timers keepalive '3'
set protocols bgp neighbor 4.0.1.1 update-source '4.0.1.2'

set protocols bgp neighbor fd:0:0:301::1111 address-family ipv6-unicast
set protocols bgp neighbor fd:0:0:301::1111 ebgp-multihop '2'
set protocols bgp neighbor fd:0:0:301::1111 remote-as '65002'
set protocols bgp neighbor fd:0:0:301::1111 timers holdtime '9'
set protocols bgp neighbor fd:0:0:301::1111 timers keepalive '3'
set protocols bgp neighbor fd:0:0:301::1111 update-source 'fd:0:0:301::2222'

set protocols bgp neighbor fd:0:0:401::1111 address-family ipv6-unicast
set protocols bgp neighbor fd:0:0:401::1111 ebgp-multihop '2'
set protocols bgp neighbor fd:0:0:401::1111 remote-as '65002'
set protocols bgp neighbor fd:0:0:401::1111 timers holdtime '9'
set protocols bgp neighbor fd:0:0:401::1111 timers keepalive '3'
set protocols bgp neighbor fd:0:0:401::1111 update-source 'fd:0:0:401::2222'

set protocols bgp parameters bestpath as-path multipath-relax

set protocols bgp parameters router-id '10.0.99.1'

set protocols bgp peer-group dyn-peers-rs-105 address-family ipv4-unicast
set protocols bgp peer-group dyn-peers-rs-105 ebgp-multihop '2'
set protocols bgp peer-group dyn-peers-rs-105 passive
set protocols bgp peer-group dyn-peers-rs-105 remote-as '64600'
set protocols bgp peer-group dyn-peers-rs-105 update-source '10.0.99.1'

set protocols bgp local-as '65004'

set service ssh port '22'

set system domain-name 'acme.local'
set system domain-search domain 'acme.local'
set system name-server 10.99.100.10

set system ntp server 0.pool.ntp.org
set system ntp server 1.pool.ntp.org
set system ntp server 2.pool.ntp.org

set system time-zone 'America/Denver'
set system name-server 10.99.100.10

set vrf bind-to-all
set vrf name oob protocols static route 0.0.0.0/0 next-hop 10.10.15.1 interface 'eth0'
set vrf name oob table '100'
